/*!For license information please see 6820-6ab378df65de445ba371.js.LICENSE.txt*/(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6820],{6316:function(e){"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),i=0,s=2,r=!0;for(;s<arguments.length;)n[i++]=arguments[s++];return new Promise((function(s,o){n[i]=function(e){if(r)if(r=!1,e)o(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];s.apply(null,t)}};try{e.apply(t||null,n)}catch(c){r&&(r=!1,o(c))}}))}},5228:function(e,t){"use strict";var n=t;n.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var i=new Array(64),s=new Array(123),r=0;r<64;)s[i[r]=r<26?r+65:r<52?r+71:r<62?r-4:r-59|43]=r++;n.encode=function(e,t,n){for(var s,r=null,o=[],c=0,a=0;t<n;){var u=e[t++];switch(a){case 0:o[c++]=i[u>>2],s=(3&u)<<4,a=1;break;case 1:o[c++]=i[s|u>>4],s=(15&u)<<2,a=2;break;case 2:o[c++]=i[s|u>>6],o[c++]=i[63&u],a=0}c>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,o)),c=0)}return a&&(o[c++]=i[s],o[c++]=61,1===a&&(o[c++]=61)),r?(c&&r.push(String.fromCharCode.apply(String,o.slice(0,c))),r.join("")):String.fromCharCode.apply(String,o.slice(0,c))};var o="invalid encoding";n.decode=function(e,t,n){for(var i,r=n,c=0,a=0;a<e.length;){var u=e.charCodeAt(a++);if(61===u&&c>1)break;if(void 0===(u=s[u]))throw Error(o);switch(c){case 0:i=u,c=1;break;case 1:t[n++]=i<<2|(48&u)>>4,i=u,c=2;break;case 2:t[n++]=(15&i)<<4|(60&u)>>2,i=u,c=3;break;case 3:t[n++]=(3&i)<<6|u,c=0}}if(1===c)throw Error(o);return n-r},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},2497:function(e){"use strict";function t(){this._listeners={}}e.exports=t,t.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},t.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this},t.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}},9331:function(e){"use strict";function t(e){return"undefined"!==typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),i=128===n[3];function s(e,i,s){t[0]=e,i[s]=n[0],i[s+1]=n[1],i[s+2]=n[2],i[s+3]=n[3]}function r(e,i,s){t[0]=e,i[s]=n[3],i[s+1]=n[2],i[s+2]=n[1],i[s+3]=n[0]}function o(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t[0]}function c(e,i){return n[3]=e[i],n[2]=e[i+1],n[1]=e[i+2],n[0]=e[i+3],t[0]}e.writeFloatLE=i?s:r,e.writeFloatBE=i?r:s,e.readFloatLE=i?o:c,e.readFloatBE=i?c:o}():function(){function t(e,t,n,i){var s=t<0?1:0;if(s&&(t=-t),0===t)e(1/t>0?0:2147483648,n,i);else if(isNaN(t))e(2143289344,n,i);else if(t>34028234663852886e22)e((s<<31|2139095040)>>>0,n,i);else if(t<11754943508222875e-54)e((s<<31|Math.round(t/1401298464324817e-60))>>>0,n,i);else{var r=Math.floor(Math.log(t)/Math.LN2);e((s<<31|r+127<<23|8388607&Math.round(t*Math.pow(2,-r)*8388608))>>>0,n,i)}}function o(e,t,n){var i=e(t,n),s=2*(i>>31)+1,r=i>>>23&255,o=8388607&i;return 255===r?o?NaN:s*(1/0):0===r?1401298464324817e-60*s*o:s*Math.pow(2,r-150)*(o+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,i),e.readFloatLE=o.bind(null,s),e.readFloatBE=o.bind(null,r)}(),"undefined"!==typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),i=128===n[7];function s(e,i,s){t[0]=e,i[s]=n[0],i[s+1]=n[1],i[s+2]=n[2],i[s+3]=n[3],i[s+4]=n[4],i[s+5]=n[5],i[s+6]=n[6],i[s+7]=n[7]}function r(e,i,s){t[0]=e,i[s]=n[7],i[s+1]=n[6],i[s+2]=n[5],i[s+3]=n[4],i[s+4]=n[3],i[s+5]=n[2],i[s+6]=n[1],i[s+7]=n[0]}function o(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],n[4]=e[i+4],n[5]=e[i+5],n[6]=e[i+6],n[7]=e[i+7],t[0]}function c(e,i){return n[7]=e[i],n[6]=e[i+1],n[5]=e[i+2],n[4]=e[i+3],n[3]=e[i+4],n[2]=e[i+5],n[1]=e[i+6],n[0]=e[i+7],t[0]}e.writeDoubleLE=i?s:r,e.writeDoubleBE=i?r:s,e.readDoubleLE=i?o:c,e.readDoubleBE=i?c:o}():function(){function t(e,t,n,i,s,r){var o=i<0?1:0;if(o&&(i=-i),0===i)e(0,s,r+t),e(1/i>0?0:2147483648,s,r+n);else if(isNaN(i))e(0,s,r+t),e(2146959360,s,r+n);else if(i>17976931348623157e292)e(0,s,r+t),e((o<<31|2146435072)>>>0,s,r+n);else{var c;if(i<22250738585072014e-324)e((c=i/5e-324)>>>0,s,r+t),e((o<<31|c/4294967296)>>>0,s,r+n);else{var a=Math.floor(Math.log(i)/Math.LN2);1024===a&&(a=1023),e(4503599627370496*(c=i*Math.pow(2,-a))>>>0,s,r+t),e((o<<31|a+1023<<20|1048576*c&1048575)>>>0,s,r+n)}}}function o(e,t,n,i,s){var r=e(i,s+t),o=e(i,s+n),c=2*(o>>31)+1,a=o>>>20&2047,u=4294967296*(1048575&o)+r;return 2047===a?u?NaN:c*(1/0):0===a?5e-324*c*u:c*Math.pow(2,a-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,i,4,0),e.readDoubleLE=o.bind(null,s,0,4),e.readDoubleBE=o.bind(null,r,4,0)}(),e}function n(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function i(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function r(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=t(t)},276:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},2897:function(e){"use strict";e.exports=function(e,t,n){var i=n||8192,s=i>>>1,r=null,o=i;return function(n){if(n<1||n>s)return e(n);o+n>i&&(r=e(i),o=0);var c=t.call(r,o,o+=n);return 7&o&&(o=1+(7|o)),c}}},6564:function(e,t){"use strict";var n=t;n.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:55296===(64512&n)&&56320===(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},n.read=function(e,t,n){if(n-t<1)return"";for(var i,s=null,r=[],o=0;t<n;)(i=e[t++])<128?r[o++]=i:i>191&&i<224?r[o++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,r[o++]=55296+(i>>10),r[o++]=56320+(1023&i)):r[o++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,r)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,r.slice(0,o))),s.join("")):String.fromCharCode.apply(String,r.slice(0,o))},n.write=function(e,t,n){for(var i,s,r=n,o=0;o<e.length;++o)(i=e.charCodeAt(o))<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&56320===(64512&(s=e.charCodeAt(o+1)))?(i=65536+((1023&i)<<10)+(1023&s),++o,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-r}},1956:function(e,t,n){"use strict";n.d(t,{Be:function(){return y}});var i={logger:"undefined"!==typeof console?console:void 0,WebSocket:"undefined"!==typeof WebSocket?WebSocket:void 0},s={log(...e){this.enabled&&(e.push(Date.now()),i.logger.log("[ActionCable]",...e))}};const r=()=>(new Date).getTime(),o=e=>(r()-e)/1e3;class c{constructor(e){this.visibilityDidChange=this.visibilityDidChange.bind(this),this.connection=e,this.reconnectAttempts=0}start(){this.isRunning()||(this.startedAt=r(),delete this.stoppedAt,this.startPolling(),addEventListener("visibilitychange",this.visibilityDidChange),s.log(`ConnectionMonitor started. stale threshold = ${this.constructor.staleThreshold} s`))}stop(){this.isRunning()&&(this.stoppedAt=r(),this.stopPolling(),removeEventListener("visibilitychange",this.visibilityDidChange),s.log("ConnectionMonitor stopped"))}isRunning(){return this.startedAt&&!this.stoppedAt}recordMessage(){this.pingedAt=r()}recordConnect(){this.reconnectAttempts=0,delete this.disconnectedAt,s.log("ConnectionMonitor recorded connect")}recordDisconnect(){this.disconnectedAt=r(),s.log("ConnectionMonitor recorded disconnect")}startPolling(){this.stopPolling(),this.poll()}stopPolling(){clearTimeout(this.pollTimeout)}poll(){this.pollTimeout=setTimeout((()=>{this.reconnectIfStale(),this.poll()}),this.getPollInterval())}getPollInterval(){const{staleThreshold:e,reconnectionBackoffRate:t}=this.constructor;return 1e3*e*Math.pow(1+t,Math.min(this.reconnectAttempts,10))*(1+(0===this.reconnectAttempts?1:t)*Math.random())}reconnectIfStale(){this.connectionIsStale()&&(s.log(`ConnectionMonitor detected stale connection. reconnectAttempts = ${this.reconnectAttempts}, time stale = ${o(this.refreshedAt)} s, stale threshold = ${this.constructor.staleThreshold} s`),this.reconnectAttempts++,this.disconnectedRecently()?s.log(`ConnectionMonitor skipping reopening recent disconnect. time disconnected = ${o(this.disconnectedAt)} s`):(s.log("ConnectionMonitor reopening"),this.connection.reopen()))}get refreshedAt(){return this.pingedAt?this.pingedAt:this.startedAt}connectionIsStale(){return o(this.refreshedAt)>this.constructor.staleThreshold}disconnectedRecently(){return this.disconnectedAt&&o(this.disconnectedAt)<this.constructor.staleThreshold}visibilityDidChange(){"visible"===document.visibilityState&&setTimeout((()=>{!this.connectionIsStale()&&this.connection.isOpen()||(s.log(`ConnectionMonitor reopening stale connection on visibilitychange. visibilityState = ${document.visibilityState}`),this.connection.reopen())}),200)}}c.staleThreshold=6,c.reconnectionBackoffRate=.15;var a={message_types:{welcome:"welcome",disconnect:"disconnect",ping:"ping",confirmation:"confirm_subscription",rejection:"reject_subscription"},disconnect_reasons:{unauthorized:"unauthorized",invalid_request:"invalid_request",server_restart:"server_restart",remote:"remote"},default_mount_path:"/cable",protocols:["actioncable-v1-json","actioncable-unsupported"]};const{message_types:u,protocols:l}=a,h=l.slice(0,l.length-1),f=[].indexOf;class d{constructor(e){this.open=this.open.bind(this),this.consumer=e,this.subscriptions=this.consumer.subscriptions,this.monitor=new c(this),this.disconnected=!0}send(e){return!!this.isOpen()&&(this.webSocket.send(JSON.stringify(e)),!0)}open(){if(this.isActive())return s.log(`Attempted to open WebSocket, but existing socket is ${this.getState()}`),!1;{const e=[...l,...this.consumer.subprotocols||[]];return s.log(`Opening WebSocket, current state is ${this.getState()}, subprotocols: ${e}`),this.webSocket&&this.uninstallEventHandlers(),this.webSocket=new i.WebSocket(this.consumer.url,e),this.installEventHandlers(),this.monitor.start(),!0}}close({allowReconnect:e}={allowReconnect:!0}){if(e||this.monitor.stop(),this.isOpen())return this.webSocket.close()}reopen(){if(s.log(`Reopening WebSocket, current state is ${this.getState()}`),!this.isActive())return this.open();try{return this.close()}catch(e){s.log("Failed to reopen WebSocket",e)}finally{s.log(`Reopening WebSocket in ${this.constructor.reopenDelay}ms`),setTimeout(this.open,this.constructor.reopenDelay)}}getProtocol(){if(this.webSocket)return this.webSocket.protocol}isOpen(){return this.isState("open")}isActive(){return this.isState("open","connecting")}triedToReconnect(){return this.monitor.reconnectAttempts>0}isProtocolSupported(){return f.call(h,this.getProtocol())>=0}isState(...e){return f.call(e,this.getState())>=0}getState(){if(this.webSocket)for(let e in i.WebSocket)if(i.WebSocket[e]===this.webSocket.readyState)return e.toLowerCase();return null}installEventHandlers(){for(let e in this.events){const t=this.events[e].bind(this);this.webSocket[`on${e}`]=t}}uninstallEventHandlers(){for(let e in this.events)this.webSocket[`on${e}`]=function(){}}}d.reopenDelay=500,d.prototype.events={message(e){if(!this.isProtocolSupported())return;const{identifier:t,message:n,reason:i,reconnect:r,type:o}=JSON.parse(e.data);switch(this.monitor.recordMessage(),o){case u.welcome:return this.triedToReconnect()&&(this.reconnectAttempted=!0),this.monitor.recordConnect(),this.subscriptions.reload();case u.disconnect:return s.log(`Disconnecting. Reason: ${i}`),this.close({allowReconnect:r});case u.ping:return null;case u.confirmation:return this.subscriptions.confirmSubscription(t),this.reconnectAttempted?(this.reconnectAttempted=!1,this.subscriptions.notify(t,"connected",{reconnected:!0})):this.subscriptions.notify(t,"connected",{reconnected:!1});case u.rejection:return this.subscriptions.reject(t);default:return this.subscriptions.notify(t,"received",n)}},open(){if(s.log(`WebSocket onopen event, using '${this.getProtocol()}' subprotocol`),this.disconnected=!1,!this.isProtocolSupported())return s.log("Protocol is unsupported. Stopping monitor and disconnecting."),this.close({allowReconnect:!1})},close(e){if(s.log("WebSocket onclose event"),!this.disconnected)return this.disconnected=!0,this.monitor.recordDisconnect(),this.subscriptions.notifyAll("disconnected",{willAttemptReconnect:this.monitor.isRunning()})},error(){s.log("WebSocket onerror event")}};class p{constructor(e,t={},n){this.consumer=e,this.identifier=JSON.stringify(t),function(e,t){if(null!=t)for(let n in t){const i=t[n];e[n]=i}}(this,n)}perform(e,t={}){return t.action=e,this.send(t)}send(e){return this.consumer.send({command:"message",identifier:this.identifier,data:JSON.stringify(e)})}unsubscribe(){return this.consumer.subscriptions.remove(this)}}class g{constructor(e){this.subscriptions=e,this.pendingSubscriptions=[]}guarantee(e){-1==this.pendingSubscriptions.indexOf(e)?(s.log(`SubscriptionGuarantor guaranteeing ${e.identifier}`),this.pendingSubscriptions.push(e)):s.log(`SubscriptionGuarantor already guaranteeing ${e.identifier}`),this.startGuaranteeing()}forget(e){s.log(`SubscriptionGuarantor forgetting ${e.identifier}`),this.pendingSubscriptions=this.pendingSubscriptions.filter((t=>t!==e))}startGuaranteeing(){this.stopGuaranteeing(),this.retrySubscribing()}stopGuaranteeing(){clearTimeout(this.retryTimeout)}retrySubscribing(){this.retryTimeout=setTimeout((()=>{this.subscriptions&&"function"===typeof this.subscriptions.subscribe&&this.pendingSubscriptions.map((e=>{s.log(`SubscriptionGuarantor resubscribing ${e.identifier}`),this.subscriptions.subscribe(e)}))}),500)}}class b{constructor(e){this.consumer=e,this.guarantor=new g(this),this.subscriptions=[]}create(e,t){const n="object"===typeof e?e:{channel:e},i=new p(this.consumer,n,t);return this.add(i)}add(e){return this.subscriptions.push(e),this.consumer.ensureActiveConnection(),this.notify(e,"initialized"),this.subscribe(e),e}remove(e){return this.forget(e),this.findAll(e.identifier).length||this.sendCommand(e,"unsubscribe"),e}reject(e){return this.findAll(e).map((e=>(this.forget(e),this.notify(e,"rejected"),e)))}forget(e){return this.guarantor.forget(e),this.subscriptions=this.subscriptions.filter((t=>t!==e)),e}findAll(e){return this.subscriptions.filter((t=>t.identifier===e))}reload(){return this.subscriptions.map((e=>this.subscribe(e)))}notifyAll(e,...t){return this.subscriptions.map((n=>this.notify(n,e,...t)))}notify(e,t,...n){let i;return i="string"===typeof e?this.findAll(e):[e],i.map((e=>"function"===typeof e[t]?e[t](...n):void 0))}subscribe(e){this.sendCommand(e,"subscribe")&&this.guarantor.guarantee(e)}confirmSubscription(e){s.log(`Subscription confirmed ${e}`),this.findAll(e).map((e=>this.guarantor.forget(e)))}sendCommand(e,t){const{identifier:n}=e;return this.consumer.send({command:t,identifier:n})}}class m{constructor(e){this._url=e,this.subscriptions=new b(this),this.connection=new d(this),this.subprotocols=[]}get url(){return function(e){"function"===typeof e&&(e=e());if(e&&!/^wss?:/i.test(e)){const t=document.createElement("a");return t.href=e,t.href=t.href,t.protocol=t.protocol.replace("http","ws"),t.href}return e}(this._url)}send(e){return this.connection.send(e)}connect(){return this.connection.open()}disconnect(){return this.connection.close({allowReconnect:!1})}ensureActiveConnection(){if(!this.connection.isActive())return this.connection.open()}addSubProtocol(e){this.subprotocols=[...this.subprotocols,e]}}function y(e=function(e){const t=document.head.querySelector(`meta[name='action-cable-${e}']`);if(t)return t.getAttribute("content")}("url")||a.default_mount_path){return new m(e)}},4677:function(e,t,n){e=n.nmd(e),function(){"use strict";function t(e,t){if(t&&t.multiple&&!Array.isArray(e))throw new Error("Invalid argument type: Expected an Array to serialize multiple values.");const n=4294967296;let i,s,r=new Uint8Array(128),o=0;if(t&&t.multiple)for(let d=0;d<e.length;d++)c(e[d]);else c(e);return r.subarray(0,o);function c(e,r){switch(typeof e){case"undefined":a(e);break;case"boolean":!function(e){l(e?195:194)}(e);break;case"number":!function(e){if(isFinite(e)&&Math.floor(e)===e)if(e>=0&&e<=127)l(e);else if(e<0&&e>=-32)l(e);else if(e>0&&e<=255)h([204,e]);else if(e>=-128&&e<=127)h([208,e]);else if(e>0&&e<=65535)h([205,e>>>8,e]);else if(e>=-32768&&e<=32767)h([209,e>>>8,e]);else if(e>0&&e<=4294967295)h([206,e>>>24,e>>>16,e>>>8,e]);else if(e>=-2147483648&&e<=2147483647)h([210,e>>>24,e>>>16,e>>>8,e]);else if(e>0&&e<=0x10000000000000000){let t=e/n,i=e%n;h([211,t>>>24,t>>>16,t>>>8,t,i>>>24,i>>>16,i>>>8,i])}else e>=-0x8000000000000000&&e<=0x8000000000000000?(l(211),f(e)):h(e<0?[211,128,0,0,0,0,0,0,0]:[207,255,255,255,255,255,255,255,255]);else s||(i=new ArrayBuffer(8),s=new DataView(i)),s.setFloat64(0,e),l(203),h(new Uint8Array(i))}(e);break;case"string":!function(e){let t=function(e){let t=!0,n=e.length;for(let r=0;r<n;r++)if(e.charCodeAt(r)>127){t=!1;break}let i=0,s=new Uint8Array(e.length*(t?1:4));for(let r=0;r!==n;r++){let t=e.charCodeAt(r);if(t<128)s[i++]=t;else{if(t<2048)s[i++]=t>>6|192;else{if(t>55295&&t<56320){if(++r>=n)throw new Error("UTF-8 encode: incomplete surrogate pair");let o=e.charCodeAt(r);if(o<56320||o>57343)throw new Error("UTF-8 encode: second surrogate character 0x"+o.toString(16)+" at index "+r+" out of range");t=65536+((1023&t)<<10)+(1023&o),s[i++]=t>>18|240,s[i++]=t>>12&63|128}else s[i++]=t>>12|224;s[i++]=t>>6&63|128}s[i++]=63&t|128}}return t?s:s.subarray(0,i)}(e),n=t.length;n<=31?l(160+n):h(n<=255?[217,n]:n<=65535?[218,n>>>8,n]:[219,n>>>24,n>>>16,n>>>8,n]);h(t)}(e);break;case"object":null===e?a(e):e instanceof Date?function(e){let t=e.getTime()/1e3;if(0===e.getMilliseconds()&&t>=0&&t<4294967296)h([214,255,t>>>24,t>>>16,t>>>8,t]);else if(t>=0&&t<17179869184){let i=1e6*e.getMilliseconds();h([215,255,i>>>22,i>>>14,i>>>6,i<<2>>>0|t/n,t>>>24,t>>>16,t>>>8,t])}else{let n=1e6*e.getMilliseconds();h([199,12,255,n>>>24,n>>>16,n>>>8,n]),f(t)}}(e):Array.isArray(e)?u(e):e instanceof Uint8Array||e instanceof Uint8ClampedArray?function(e){let t=e.length;h(t<=15?[196,t]:t<=65535?[197,t>>>8,t]:[198,t>>>24,t>>>16,t>>>8,t]);h(e)}(e):e instanceof Int8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array?u(e):function(e){let t=0;for(let n in e)void 0!==e[n]&&t++;t<=15?l(128+t):h(t<=65535?[222,t>>>8,t]:[223,t>>>24,t>>>16,t>>>8,t]);for(let n in e){let t=e[n];void 0!==t&&(c(n),c(t))}}(e);break;default:if(r||!t||!t.invalidTypeReplacement)throw new Error("Invalid argument type: The type '"+typeof e+"' cannot be serialized.");"function"===typeof t.invalidTypeReplacement?c(t.invalidTypeReplacement(e),!0):c(t.invalidTypeReplacement,!0)}}function a(e){l(192)}function u(e){let t=e.length;t<=15?l(144+t):h(t<=65535?[220,t>>>8,t]:[221,t>>>24,t>>>16,t>>>8,t]);for(let n=0;n<t;n++)c(e[n])}function l(e){if(r.length<o+1){let e=2*r.length;for(;e<o+1;)e*=2;let t=new Uint8Array(e);t.set(r),r=t}r[o]=e,o++}function h(e){if(r.length<o+e.length){let t=2*r.length;for(;t<o+e.length;)t*=2;let n=new Uint8Array(t);n.set(r),r=n}r.set(e,o),o+=e.length}function f(e){let t,i;e>=0?(t=e/n,i=e%n):(e++,t=Math.abs(e)/n,i=Math.abs(e)%n,t=~t,i=~i),h([t>>>24,t>>>16,t>>>8,t,i>>>24,i>>>16,i>>>8,i])}}function n(e,t){const n=4294967296;let i,s=0;if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),"object"!==typeof e||"undefined"===typeof e.length)throw new Error("Invalid argument type: Expected a byte array (Array or Uint8Array) to deserialize.");if(!e.length)throw new Error("Invalid argument: The byte array to deserialize is empty.");if(e instanceof Uint8Array||(e=new Uint8Array(e)),t&&t.multiple)for(i=[];s<e.length;)i.push(r());else i=r();return i;function r(){const t=e[s++];if(t>=0&&t<=127)return t;if(t>=128&&t<=143)return l(t-128);if(t>=144&&t<=159)return h(t-144);if(t>=160&&t<=191)return f(t-160);if(192===t)return null;if(193===t)throw new Error("Invalid byte code 0xc1 found.");if(194===t)return!1;if(195===t)return!0;if(196===t)return u(-1,1);if(197===t)return u(-1,2);if(198===t)return u(-1,4);if(199===t)return d(-1,1);if(200===t)return d(-1,2);if(201===t)return d(-1,4);if(202===t)return a(4);if(203===t)return a(8);if(204===t)return c(1);if(205===t)return c(2);if(206===t)return c(4);if(207===t)return c(8);if(208===t)return o(1);if(209===t)return o(2);if(210===t)return o(4);if(211===t)return o(8);if(212===t)return d(1);if(213===t)return d(2);if(214===t)return d(4);if(215===t)return d(8);if(216===t)return d(16);if(217===t)return f(-1,1);if(218===t)return f(-1,2);if(219===t)return f(-1,4);if(220===t)return h(-1,2);if(221===t)return h(-1,4);if(222===t)return l(-1,2);if(223===t)return l(-1,4);if(t>=224&&t<=255)return t-256;throw console.debug("msgpack array:",e),new Error("Invalid byte value '"+t+"' at index "+(s-1)+" in the MessagePack binary data (length "+e.length+"): Expecting a range of 0 to 255. This is not a byte array.")}function o(t){let n=0,i=!0;for(;t-->0;)if(i){let t=e[s++];n+=127&t,128&t&&(n-=128),i=!1}else n*=256,n+=e[s++];return n}function c(t){let n=0;for(;t-->0;)n*=256,n+=e[s++];return n}function a(t){let n=new DataView(e.buffer,s+e.byteOffset,t);return s+=t,4===t?n.getFloat32(0,!1):8===t?n.getFloat64(0,!1):void 0}function u(t,n){t<0&&(t=c(n));let i=e.subarray(s,s+t);return s+=t,i}function l(e,t){e<0&&(e=c(t));let n={};for(;e-->0;){n[r()]=r()}return n}function h(e,t){e<0&&(e=c(t));let n=[];for(;e-->0;)n.push(r());return n}function f(t,n){t<0&&(t=c(n));let i=s;return s+=t,function(e,t,n){let i=t,s="";n+=t;for(;i<n;){let t=e[i++];if(t>127)if(t>191&&t<224){if(i>=n)throw new Error("UTF-8 decode: incomplete 2-byte sequence");t=(31&t)<<6|63&e[i++]}else if(t>223&&t<240){if(i+1>=n)throw new Error("UTF-8 decode: incomplete 3-byte sequence");t=(15&t)<<12|(63&e[i++])<<6|63&e[i++]}else{if(!(t>239&&t<248))throw new Error("UTF-8 decode: unknown multibyte start 0x"+t.toString(16)+" at index "+(i-1));if(i+2>=n)throw new Error("UTF-8 decode: incomplete 4-byte sequence");t=(7&t)<<18|(63&e[i++])<<12|(63&e[i++])<<6|63&e[i++]}if(t<=65535)s+=String.fromCharCode(t);else{if(!(t<=1114111))throw new Error("UTF-8 decode: code point 0x"+t.toString(16)+" exceeds UTF-16 reach");t-=65536,s+=String.fromCharCode(t>>10|55296),s+=String.fromCharCode(1023&t|56320)}}return s}(e,i,t)}function d(e,t){e<0&&(e=c(t));let i=c(1),r=u(e);return 255===i?function(e){if(4===e.length){let t=(e[0]<<24>>>0)+(e[1]<<16>>>0)+(e[2]<<8>>>0)+e[3];return new Date(1e3*t)}if(8===e.length){let t=(e[0]<<22>>>0)+(e[1]<<14>>>0)+(e[2]<<6>>>0)+(e[3]>>>2),i=(3&e[3])*n+(e[4]<<24>>>0)+(e[5]<<16>>>0)+(e[6]<<8>>>0)+e[7];return new Date(1e3*i+t/1e6)}if(12===e.length){let t=(e[0]<<24>>>0)+(e[1]<<16>>>0)+(e[2]<<8>>>0)+e[3];s-=8;let n=o(8);return new Date(1e3*n+t/1e6)}throw new Error("Invalid data length for a date value.")}(r):{type:i,data:r}}}let i={serialize:t,deserialize:n,encode:t,decode:n};e&&"object"===typeof e.exports?e.exports=i:window[window.msgpackJsName||"msgpack"]=i}()},405:function(e,t,n){"use strict";e.exports=n(9797)},9797:function(e,t,n){"use strict";var i=t;function s(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=n(1912),i.BufferWriter=n(6329),i.Reader=n(108),i.BufferReader=n(5885),i.util=n(3111),i.rpc=n(3868),i.roots=n(1950),i.configure=s,s()},108:function(e,t,n){"use strict";e.exports=a;var i,s=n(3111),r=s.LongBits,o=s.utf8;function c(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function a(e){this.buf=e,this.pos=0,this.len=e.length}var u,l="undefined"!==typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new a(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new a(e);throw Error("illegal buffer")},h=function(){return s.Buffer?function(e){return(a.create=function(e){return s.Buffer.isBuffer(e)?new i(e):l(e)})(e)}:l};function f(){var e=new r(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw c(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw c(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw c(this,8);return new r(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}a.create=h(),a.prototype._slice=s.Array.prototype.subarray||s.Array.prototype.slice,a.prototype.uint32=(u=4294967295,function(){if(u=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return u;if(u=(u|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return u;if((this.pos+=5)>this.len)throw this.pos=this.len,c(this,10);return u}),a.prototype.int32=function(){return 0|this.uint32()},a.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},a.prototype.bool=function(){return 0!==this.uint32()},a.prototype.fixed32=function(){if(this.pos+4>this.len)throw c(this,4);return d(this.buf,this.pos+=4)},a.prototype.sfixed32=function(){if(this.pos+4>this.len)throw c(this,4);return 0|d(this.buf,this.pos+=4)},a.prototype.float=function(){if(this.pos+4>this.len)throw c(this,4);var e=s.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},a.prototype.double=function(){if(this.pos+8>this.len)throw c(this,4);var e=s.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},a.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw c(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,n);if(t===n){var i=s.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,n)},a.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},a.prototype.skip=function(e){if("number"===typeof e){if(this.pos+e>this.len)throw c(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw c(this)}while(128&this.buf[this.pos++]);return this},a.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!==(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},a._configure=function(e){i=e,a.create=h(),i._configure();var t=s.Long?"toLong":"toNumber";s.merge(a.prototype,{int64:function(){return f.call(this)[t](!1)},uint64:function(){return f.call(this)[t](!0)},sint64:function(){return f.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},5885:function(e,t,n){"use strict";e.exports=r;var i=n(108);(r.prototype=Object.create(i.prototype)).constructor=r;var s=n(3111);function r(e){i.call(this,e)}r._configure=function(){s.Buffer&&(r.prototype._slice=s.Buffer.prototype.slice)},r.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},r._configure()},1950:function(e){"use strict";e.exports={}},3868:function(e,t,n){"use strict";t.Service=n(8776)},8776:function(e,t,n){"use strict";e.exports=s;var i=n(3111);function s(e,t,n){if("function"!==typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(s.prototype=Object.create(i.EventEmitter.prototype)).constructor=s,s.prototype.rpcCall=function e(t,n,s,r,o){if(!r)throw TypeError("request must be specified");var c=this;if(!o)return i.asPromise(e,c,t,n,s,r);if(c.rpcImpl)try{return c.rpcImpl(t,n[c.requestDelimited?"encodeDelimited":"encode"](r).finish(),(function(e,n){if(e)return c.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof s))try{n=s[c.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return c.emit("error",e,t),o(e)}return c.emit("data",n,t),o(null,n)}c.end(!0)}))}catch(a){return c.emit("error",a,t),void setTimeout((function(){o(a)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},s.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},9964:function(e,t,n){"use strict";e.exports=s;var i=n(3111);function s(e,t){this.lo=e>>>0,this.hi=t>>>0}var r=s.zero=new s(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var o=s.zeroHash="\0\0\0\0\0\0\0\0";s.fromNumber=function(e){if(0===e)return r;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new s(n,i)},s.from=function(e){if("number"===typeof e)return s.fromNumber(e);if(i.isString(e)){if(!i.Long)return s.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new s(e.low>>>0,e.high>>>0):r},s.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},s.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var c=String.prototype.charCodeAt;s.fromHash=function(e){return e===o?r:new s((c.call(e,0)|c.call(e,1)<<8|c.call(e,2)<<16|c.call(e,3)<<24)>>>0,(c.call(e,4)|c.call(e,5)<<8|c.call(e,6)<<16|c.call(e,7)<<24)>>>0)},s.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},s.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},s.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},s.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},3111:function(e,t,n){"use strict";var i=t;function s(e,t,n){for(var i=Object.keys(t),s=0;s<i.length;++s)void 0!==e[i[s]]&&n||(e[i[s]]=t[i[s]]);return e}function r(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&s(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}i.asPromise=n(6316),i.base64=n(5228),i.EventEmitter=n(2497),i.float=n(9331),i.inquire=n(276),i.utf8=n(6564),i.pool=n(2897),i.LongBits=n(9964),i.isNode=Boolean("undefined"!==typeof n.g&&n.g&&n.g.process&&n.g.process.versions&&n.g.process.versions.node),i.global=i.isNode&&n.g||"undefined"!==typeof window&&window||"undefined"!==typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(e){return"number"===typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"===typeof e||e instanceof String},i.isObject=function(e){return e&&"object"===typeof e},i.isset=i.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!==typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(t){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"===typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"===typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!==typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var n=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},i.merge=s,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=r,i.ProtocolError=r("ProtocolError"),i.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},i.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var e=i.Buffer;e?(i._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},i._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):i._Buffer_from=i._Buffer_allocUnsafe=null}},1912:function(e,t,n){"use strict";e.exports=h;var i,s=n(3111),r=s.LongBits,o=s.base64,c=s.utf8;function a(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function u(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new a(u,0,0),this.tail=this.head,this.states=null}var f=function(){return s.Buffer?function(){return(h.create=function(){return new i})()}:function(){return new h}};function d(e,t,n){t[n]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function b(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}h.create=f(),h.alloc=function(e){return new s.Array(e)},s.Array!==Array&&(h.alloc=s.pool(h.alloc,s.Array.prototype.subarray)),h.prototype._push=function(e,t,n){return this.tail=this.tail.next=new a(e,t,n),this.len+=t,this},p.prototype=Object.create(a.prototype),p.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(g,10,r.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=r.from(e);return this._push(g,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=r.from(e).zzEncode();return this._push(g,t.length(),t)},h.prototype.bool=function(e){return this._push(d,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(b,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=r.from(e);return this._push(b,4,t.lo)._push(b,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(s.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(s.float.writeDoubleLE,8,e)};var m=s.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(d,1,0);if(s.isString(e)){var n=h.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(m,t,e)},h.prototype.string=function(e){var t=c.length(e);return t?this.uint32(t)._push(c.write,t,e):this._push(d,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new a(u,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new a(u,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},h._configure=function(e){i=e,h.create=f(),i._configure()}},6329:function(e,t,n){"use strict";e.exports=r;var i=n(1912);(r.prototype=Object.create(i.prototype)).constructor=r;var s=n(3111);function r(){i.call(this)}function o(e,t,n){e.length<40?s.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}r._configure=function(){r.alloc=s._Buffer_allocUnsafe,r.writeBytesBuffer=s.Buffer&&s.Buffer.prototype instanceof Uint8Array&&"set"===s.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]}},r.prototype.bytes=function(e){s.isString(e)&&(e=s._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(r.writeBytesBuffer,t,e),this},r.prototype.string=function(e){var t=s.Buffer.byteLength(e);return this.uint32(t),t&&this._push(o,t,e),this},r._configure()},1971:function(e,t,n){"use strict";n.d(t,{a:function(){return p}});var i=n(4677),s=n(405);s.util.Long=void 0,s.configure();const r=s.Reader,o=s.Writer,c=s.util,a=s.roots.default||(s.roots.default={}),u=a.action_cable=(()=>{const e={};return e.Type=function(){const e={},t=Object.create(e);return t[e[0]="no_type"]=0,t[e[1]="welcome"]=1,t[e[2]="disconnect"]=2,t[e[3]="ping"]=3,t[e[4]="confirm_subscription"]=4,t[e[5]="reject_subscription"]=5,t[e[6]="confirm_history"]=6,t[e[7]="reject_history"]=7,t}(),e.Command=function(){const e={},t=Object.create(e);return t[e[0]="unknown_command"]=0,t[e[1]="subscribe"]=1,t[e[2]="unsubscribe"]=2,t[e[3]="message"]=3,t[e[4]="history"]=4,t[e[5]="pong"]=5,t}(),e.StreamHistoryRequest=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.epoch="",e.prototype.offset=c.Long?c.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.epoch&&Object.hasOwnProperty.call(e,"epoch")&&t.uint32(18).string(e.epoch),null!=e.offset&&Object.hasOwnProperty.call(e,"offset")&&t.uint32(24).int64(e.offset),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let n=void 0===t?e.len:e.pos+t,i=new a.action_cable.StreamHistoryRequest;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 2:i.epoch=e.string();break;case 3:i.offset=e.int64();break;default:e.skipType(7&t)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!==typeof e||null===e?"object expected":null!=e.epoch&&e.hasOwnProperty("epoch")&&!c.isString(e.epoch)?"epoch: string expected":null==e.offset||!e.hasOwnProperty("offset")||c.isInteger(e.offset)||e.offset&&c.isInteger(e.offset.low)&&c.isInteger(e.offset.high)?null:"offset: integer|Long expected"},e.fromObject=function(e){if(e instanceof a.action_cable.StreamHistoryRequest)return e;let t=new a.action_cable.StreamHistoryRequest;return null!=e.epoch&&(t.epoch=String(e.epoch)),null!=e.offset&&(c.Long?(t.offset=c.Long.fromValue(e.offset)).unsigned=!1:"string"===typeof e.offset?t.offset=parseInt(e.offset,10):"number"===typeof e.offset?t.offset=e.offset:"object"===typeof e.offset&&(t.offset=new c.LongBits(e.offset.low>>>0,e.offset.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});let n={};if(t.defaults)if(n.epoch="",c.Long){let e=new c.Long(0,0,!1);n.offset=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else n.offset=t.longs===String?"0":0;return null!=e.epoch&&e.hasOwnProperty("epoch")&&(n.epoch=e.epoch),null!=e.offset&&e.hasOwnProperty("offset")&&("number"===typeof e.offset?n.offset=t.longs===String?String(e.offset):e.offset:n.offset=t.longs===String?c.Long.prototype.toString.call(e.offset):t.longs===Number?new c.LongBits(e.offset.low>>>0,e.offset.high>>>0).toNumber():e.offset),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/action_cable.StreamHistoryRequest"},e}(),e.HistoryRequest=function(){function e(e){if(this.streams={},e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.since=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.streams=c.emptyObject,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.since&&Object.hasOwnProperty.call(e,"since")&&t.uint32(8).int64(e.since),null!=e.streams&&Object.hasOwnProperty.call(e,"streams"))for(let n=Object.keys(e.streams),i=0;i<n.length;++i)t.uint32(18).fork().uint32(10).string(n[i]),a.action_cable.StreamHistoryRequest.encode(e.streams[n[i]],t.uint32(18).fork()).ldelim().ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let n,i,s=void 0===t?e.len:e.pos+t,o=new a.action_cable.HistoryRequest;for(;e.pos<s;){let t=e.uint32();switch(t>>>3){case 1:o.since=e.int64();break;case 2:{o.streams===c.emptyObject&&(o.streams={});let t=e.uint32()+e.pos;for(n="",i=null;e.pos<t;){let t=e.uint32();switch(t>>>3){case 1:n=e.string();break;case 2:i=a.action_cable.StreamHistoryRequest.decode(e,e.uint32());break;default:e.skipType(7&t)}}o.streams[n]=i;break}default:e.skipType(7&t)}}return o},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.since&&e.hasOwnProperty("since")&&!c.isInteger(e.since)&&!(e.since&&c.isInteger(e.since.low)&&c.isInteger(e.since.high)))return"since: integer|Long expected";if(null!=e.streams&&e.hasOwnProperty("streams")){if(!c.isObject(e.streams))return"streams: object expected";let t=Object.keys(e.streams);for(let n=0;n<t.length;++n){let i=a.action_cable.StreamHistoryRequest.verify(e.streams[t[n]]);if(i)return"streams."+i}}return null},e.fromObject=function(e){if(e instanceof a.action_cable.HistoryRequest)return e;let t=new a.action_cable.HistoryRequest;if(null!=e.since&&(c.Long?(t.since=c.Long.fromValue(e.since)).unsigned=!1:"string"===typeof e.since?t.since=parseInt(e.since,10):"number"===typeof e.since?t.since=e.since:"object"===typeof e.since&&(t.since=new c.LongBits(e.since.low>>>0,e.since.high>>>0).toNumber())),e.streams){if("object"!==typeof e.streams)throw TypeError(".action_cable.HistoryRequest.streams: object expected");t.streams={};for(let n=Object.keys(e.streams),i=0;i<n.length;++i){if("object"!==typeof e.streams[n[i]])throw TypeError(".action_cable.HistoryRequest.streams: object expected");t.streams[n[i]]=a.action_cable.StreamHistoryRequest.fromObject(e.streams[n[i]])}}return t},e.toObject=function(e,t){t||(t={});let n,i={};if((t.objects||t.defaults)&&(i.streams={}),t.defaults)if(c.Long){let e=new c.Long(0,0,!1);i.since=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else i.since=t.longs===String?"0":0;if(null!=e.since&&e.hasOwnProperty("since")&&("number"===typeof e.since?i.since=t.longs===String?String(e.since):e.since:i.since=t.longs===String?c.Long.prototype.toString.call(e.since):t.longs===Number?new c.LongBits(e.since.low>>>0,e.since.high>>>0).toNumber():e.since),e.streams&&(n=Object.keys(e.streams)).length){i.streams={};for(let s=0;s<n.length;++s)i.streams[n[s]]=a.action_cable.StreamHistoryRequest.toObject(e.streams[n[s]],t)}return i},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/action_cable.HistoryRequest"},e}(),e.Message=function(){function e(e){if(e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.type=0,e.prototype.command=0,e.prototype.identifier="",e.prototype.data="",e.prototype.message=c.newBuffer([]),e.prototype.reason="",e.prototype.reconnect=!1,e.prototype.history=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=o.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.command&&Object.hasOwnProperty.call(e,"command")&&t.uint32(16).int32(e.command),null!=e.identifier&&Object.hasOwnProperty.call(e,"identifier")&&t.uint32(26).string(e.identifier),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(34).string(e.data),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(42).bytes(e.message),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(50).string(e.reason),null!=e.reconnect&&Object.hasOwnProperty.call(e,"reconnect")&&t.uint32(56).bool(e.reconnect),null!=e.history&&Object.hasOwnProperty.call(e,"history")&&a.action_cable.HistoryRequest.encode(e.history,t.uint32(66).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let n=void 0===t?e.len:e.pos+t,i=new a.action_cable.Message;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:i.type=e.int32();break;case 2:i.command=e.int32();break;case 3:i.identifier=e.string();break;case 4:i.data=e.string();break;case 5:i.message=e.bytes();break;case 6:i.reason=e.string();break;case 7:i.reconnect=e.bool();break;case 8:i.history=a.action_cable.HistoryRequest.decode(e,e.uint32());break;default:e.skipType(7&t)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}if(null!=e.command&&e.hasOwnProperty("command"))switch(e.command){default:return"command: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:}if(null!=e.identifier&&e.hasOwnProperty("identifier")&&!c.isString(e.identifier))return"identifier: string expected";if(null!=e.data&&e.hasOwnProperty("data")&&!c.isString(e.data))return"data: string expected";if(null!=e.message&&e.hasOwnProperty("message")&&!(e.message&&"number"===typeof e.message.length||c.isString(e.message)))return"message: buffer expected";if(null!=e.reason&&e.hasOwnProperty("reason")&&!c.isString(e.reason))return"reason: string expected";if(null!=e.reconnect&&e.hasOwnProperty("reconnect")&&"boolean"!==typeof e.reconnect)return"reconnect: boolean expected";if(null!=e.history&&e.hasOwnProperty("history")){let t=a.action_cable.HistoryRequest.verify(e.history);if(t)return"history."+t}return null},e.fromObject=function(e){if(e instanceof a.action_cable.Message)return e;let t=new a.action_cable.Message;switch(e.type){default:if("number"===typeof e.type){t.type=e.type;break}break;case"no_type":case 0:t.type=0;break;case"welcome":case 1:t.type=1;break;case"disconnect":case 2:t.type=2;break;case"ping":case 3:t.type=3;break;case"confirm_subscription":case 4:t.type=4;break;case"reject_subscription":case 5:t.type=5;break;case"confirm_history":case 6:t.type=6;break;case"reject_history":case 7:t.type=7}switch(e.command){default:if("number"===typeof e.command){t.command=e.command;break}break;case"unknown_command":case 0:t.command=0;break;case"subscribe":case 1:t.command=1;break;case"unsubscribe":case 2:t.command=2;break;case"message":case 3:t.command=3;break;case"history":case 4:t.command=4;break;case"pong":case 5:t.command=5}if(null!=e.identifier&&(t.identifier=String(e.identifier)),null!=e.data&&(t.data=String(e.data)),null!=e.message&&("string"===typeof e.message?c.base64.decode(e.message,t.message=c.newBuffer(c.base64.length(e.message)),0):e.message.length>=0&&(t.message=e.message)),null!=e.reason&&(t.reason=String(e.reason)),null!=e.reconnect&&(t.reconnect=Boolean(e.reconnect)),null!=e.history){if("object"!==typeof e.history)throw TypeError(".action_cable.Message.history: object expected");t.history=a.action_cable.HistoryRequest.fromObject(e.history)}return t},e.toObject=function(e,t){t||(t={});let n={};return t.defaults&&(n.type=t.enums===String?"no_type":0,n.command=t.enums===String?"unknown_command":0,n.identifier="",n.data="",t.bytes===String?n.message="":(n.message=[],t.bytes!==Array&&(n.message=c.newBuffer(n.message))),n.reason="",n.reconnect=!1,n.history=null),null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?void 0===a.action_cable.Type[e.type]?e.type:a.action_cable.Type[e.type]:e.type),null!=e.command&&e.hasOwnProperty("command")&&(n.command=t.enums===String?void 0===a.action_cable.Command[e.command]?e.command:a.action_cable.Command[e.command]:e.command),null!=e.identifier&&e.hasOwnProperty("identifier")&&(n.identifier=e.identifier),null!=e.data&&e.hasOwnProperty("data")&&(n.data=e.data),null!=e.message&&e.hasOwnProperty("message")&&(n.message=t.bytes===String?c.base64.encode(e.message,0,e.message.length):t.bytes===Array?Array.prototype.slice.call(e.message):e.message),null!=e.reason&&e.hasOwnProperty("reason")&&(n.reason=e.reason),null!=e.reconnect&&e.hasOwnProperty("reconnect")&&(n.reconnect=e.reconnect),null!=e.history&&e.hasOwnProperty("history")&&(n.history=a.action_cable.HistoryRequest.toObject(e.history,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/action_cable.Message"},e}(),e.Reply=function(){function e(e){if(this.restored_ids=[],e)for(let t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.type=0,e.prototype.identifier="",e.prototype.message=c.newBuffer([]),e.prototype.reason="",e.prototype.reconnect=!1,e.prototype.stream_id="",e.prototype.epoch="",e.prototype.offset=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.sid="",e.prototype.restored=!1,e.prototype.restored_ids=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=o.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.identifier&&Object.hasOwnProperty.call(e,"identifier")&&t.uint32(18).string(e.identifier),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(26).bytes(e.message),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(34).string(e.reason),null!=e.reconnect&&Object.hasOwnProperty.call(e,"reconnect")&&t.uint32(40).bool(e.reconnect),null!=e.stream_id&&Object.hasOwnProperty.call(e,"stream_id")&&t.uint32(50).string(e.stream_id),null!=e.epoch&&Object.hasOwnProperty.call(e,"epoch")&&t.uint32(58).string(e.epoch),null!=e.offset&&Object.hasOwnProperty.call(e,"offset")&&t.uint32(64).int64(e.offset),null!=e.sid&&Object.hasOwnProperty.call(e,"sid")&&t.uint32(74).string(e.sid),null!=e.restored&&Object.hasOwnProperty.call(e,"restored")&&t.uint32(80).bool(e.restored),null!=e.restored_ids&&e.restored_ids.length)for(let n=0;n<e.restored_ids.length;++n)t.uint32(90).string(e.restored_ids[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof r||(e=r.create(e));let n=void 0===t?e.len:e.pos+t,i=new a.action_cable.Reply;for(;e.pos<n;){let t=e.uint32();switch(t>>>3){case 1:i.type=e.int32();break;case 2:i.identifier=e.string();break;case 3:i.message=e.bytes();break;case 4:i.reason=e.string();break;case 5:i.reconnect=e.bool();break;case 6:i.stream_id=e.string();break;case 7:i.epoch=e.string();break;case 8:i.offset=e.int64();break;case 9:i.sid=e.string();break;case 10:i.restored=e.bool();break;case 11:i.restored_ids&&i.restored_ids.length||(i.restored_ids=[]),i.restored_ids.push(e.string());break;default:e.skipType(7&t)}}return i},e.decodeDelimited=function(e){return e instanceof r||(e=new r(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!==typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}if(null!=e.identifier&&e.hasOwnProperty("identifier")&&!c.isString(e.identifier))return"identifier: string expected";if(null!=e.message&&e.hasOwnProperty("message")&&!(e.message&&"number"===typeof e.message.length||c.isString(e.message)))return"message: buffer expected";if(null!=e.reason&&e.hasOwnProperty("reason")&&!c.isString(e.reason))return"reason: string expected";if(null!=e.reconnect&&e.hasOwnProperty("reconnect")&&"boolean"!==typeof e.reconnect)return"reconnect: boolean expected";if(null!=e.stream_id&&e.hasOwnProperty("stream_id")&&!c.isString(e.stream_id))return"stream_id: string expected";if(null!=e.epoch&&e.hasOwnProperty("epoch")&&!c.isString(e.epoch))return"epoch: string expected";if(null!=e.offset&&e.hasOwnProperty("offset")&&!c.isInteger(e.offset)&&!(e.offset&&c.isInteger(e.offset.low)&&c.isInteger(e.offset.high)))return"offset: integer|Long expected";if(null!=e.sid&&e.hasOwnProperty("sid")&&!c.isString(e.sid))return"sid: string expected";if(null!=e.restored&&e.hasOwnProperty("restored")&&"boolean"!==typeof e.restored)return"restored: boolean expected";if(null!=e.restored_ids&&e.hasOwnProperty("restored_ids")){if(!Array.isArray(e.restored_ids))return"restored_ids: array expected";for(let t=0;t<e.restored_ids.length;++t)if(!c.isString(e.restored_ids[t]))return"restored_ids: string[] expected"}return null},e.fromObject=function(e){if(e instanceof a.action_cable.Reply)return e;let t=new a.action_cable.Reply;switch(e.type){default:if("number"===typeof e.type){t.type=e.type;break}break;case"no_type":case 0:t.type=0;break;case"welcome":case 1:t.type=1;break;case"disconnect":case 2:t.type=2;break;case"ping":case 3:t.type=3;break;case"confirm_subscription":case 4:t.type=4;break;case"reject_subscription":case 5:t.type=5;break;case"confirm_history":case 6:t.type=6;break;case"reject_history":case 7:t.type=7}if(null!=e.identifier&&(t.identifier=String(e.identifier)),null!=e.message&&("string"===typeof e.message?c.base64.decode(e.message,t.message=c.newBuffer(c.base64.length(e.message)),0):e.message.length>=0&&(t.message=e.message)),null!=e.reason&&(t.reason=String(e.reason)),null!=e.reconnect&&(t.reconnect=Boolean(e.reconnect)),null!=e.stream_id&&(t.stream_id=String(e.stream_id)),null!=e.epoch&&(t.epoch=String(e.epoch)),null!=e.offset&&(c.Long?(t.offset=c.Long.fromValue(e.offset)).unsigned=!1:"string"===typeof e.offset?t.offset=parseInt(e.offset,10):"number"===typeof e.offset?t.offset=e.offset:"object"===typeof e.offset&&(t.offset=new c.LongBits(e.offset.low>>>0,e.offset.high>>>0).toNumber())),null!=e.sid&&(t.sid=String(e.sid)),null!=e.restored&&(t.restored=Boolean(e.restored)),e.restored_ids){if(!Array.isArray(e.restored_ids))throw TypeError(".action_cable.Reply.restored_ids: array expected");t.restored_ids=[];for(let n=0;n<e.restored_ids.length;++n)t.restored_ids[n]=String(e.restored_ids[n])}return t},e.toObject=function(e,t){t||(t={});let n={};if((t.arrays||t.defaults)&&(n.restored_ids=[]),t.defaults){if(n.type=t.enums===String?"no_type":0,n.identifier="",t.bytes===String?n.message="":(n.message=[],t.bytes!==Array&&(n.message=c.newBuffer(n.message))),n.reason="",n.reconnect=!1,n.stream_id="",n.epoch="",c.Long){let e=new c.Long(0,0,!1);n.offset=t.longs===String?e.toString():t.longs===Number?e.toNumber():e}else n.offset=t.longs===String?"0":0;n.sid="",n.restored=!1}if(null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?void 0===a.action_cable.Type[e.type]?e.type:a.action_cable.Type[e.type]:e.type),null!=e.identifier&&e.hasOwnProperty("identifier")&&(n.identifier=e.identifier),null!=e.message&&e.hasOwnProperty("message")&&(n.message=t.bytes===String?c.base64.encode(e.message,0,e.message.length):t.bytes===Array?Array.prototype.slice.call(e.message):e.message),null!=e.reason&&e.hasOwnProperty("reason")&&(n.reason=e.reason),null!=e.reconnect&&e.hasOwnProperty("reconnect")&&(n.reconnect=e.reconnect),null!=e.stream_id&&e.hasOwnProperty("stream_id")&&(n.stream_id=e.stream_id),null!=e.epoch&&e.hasOwnProperty("epoch")&&(n.epoch=e.epoch),null!=e.offset&&e.hasOwnProperty("offset")&&("number"===typeof e.offset?n.offset=t.longs===String?String(e.offset):e.offset:n.offset=t.longs===String?c.Long.prototype.toString.call(e.offset):t.longs===Number?new c.LongBits(e.offset.low>>>0,e.offset.high>>>0).toNumber():e.offset),null!=e.sid&&e.hasOwnProperty("sid")&&(n.sid=e.sid),null!=e.restored&&e.hasOwnProperty("restored")&&(n.restored=e.restored),e.restored_ids&&e.restored_ids.length){n.restored_ids=[];for(let t=0;t<e.restored_ids.length;++t)n.restored_ids[t]=e.restored_ids[t]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.getTypeUrl=function(e){return void 0===e&&(e="type.googleapis.com"),e+"/action_cable.Reply"},e}(),e})();class l{constructor(e){this.values=e,this.valuesById=Object.getPrototypeOf(e)}getIdByValue(e){return this.values[e]}getValueById(e){return this.valuesById[e]}}const h=u.Message,f=(u.Reply,new l(u.Type)),d=new l(u.Command);class p{encode(e){e.command=d.getIdByValue(e.command),e.type=f.getIdByValue(e.type),void 0!==e.message&&(e.message=i.serialize(e.message));let t=h.verify(e);if(t)throw Error(t);return h.encode(e).finish()}decode(e){try{let t=this.decodeReply(e);return t.type=f.getValueById(t.type),t.command=d.getValueById(t.command),t.message&&t.message.length>0&&(t.message=i.deserialize(t.message)),t}catch(t){}}decodeReply(e){return h.decode(e)}}},3320:function(e,t,n){"use strict";n.d(t,{Be:function(){return V}});let i=()=>({events:{},emit(e,...t){let n=this.events[e]||[];for(let i=0,s=n.length;i<s;i++)n[i](...t)},on(e,t){return this.events[e]?.push(t)||(this.events[e]=[t]),()=>{this.events[e]=this.events[e]?.filter((e=>t!==e))}}});class s{constructor(e){this.id=e,this.intent="unsubscribed",this.state="idle",this.channels=[],this.disposed=!1,this._pendings=[]}add(e){this.channels.includes(e)||this.channels.push(e)}remove(e){let t=this.channels.indexOf(e);t>-1&&this.channels.splice(t,1)}notify(e,...t){this.state="restored"===e?"connected":e,1===t.length?this.channels.forEach((n=>n[e](t[0]))):this.channels.forEach((t=>t[e]()))}pending(e){this._checkIntent(e);let t=this._pendings[0];return t&&t.intent===e?t.promise:Promise.resolve()}ensureResubscribed(){this.disposed||(this.intent=void 0,this.ensureSubscribed())}ensureSubscribed(){if("subscribed"===this.intent)return;if(this.disposed)throw Error("Subscription is disposed");this.intent="subscribed",this._mergeWithPending("unsubscribed")||this.subscriber(this)}maybeUnsubscribe(){if(this.disposed)return;if("unsubscribed"===this.intent)return;if(this.channels.length>0)return;this.intent="unsubscribed",this._mergeWithPending("subscribed")||this.unsubscriber(this)}async acquire(e){let t;this._checkIntent(e);let n={promise:new Promise((e=>{t=e})),intent:e,release:()=>{this._pendings.splice(this._pendings.indexOf(n),1),t(n)},canceled:!1,acquired:!1},i=this._pendingTop;return this._pendings.push(n),i&&await i.promise,this.gvl&&await this.gvl.acquire(n,e),n.acquired=!0,n}close(e){this.disposed=!0,this.intent=void 0,this.notify("closed",e)}_checkIntent(e){if("unsubscribed"!==e&&"subscribed"!==e)throw Error(`Unknown subscription intent: ${e}`)}get _pendingTop(){return this._pendings.length?this._pendings[this._pendings.length-1]:void 0}_mergeWithPending(e){let t=this._pendingTop;return!!t&&(!t.acquired&&(t.intent===e&&(this._pendings.pop(),t.canceled=!0,!0)))}}class r{constructor(){this.queue=[]}async acquire(e,t){"subscribed"===t&&(this.queue.push(e.promise.then((()=>{this.queue.splice(this.queue.indexOf(e),1)}))),this.queue.length>1&&await this.queue[this.queue.length-2])}}class o{constructor(e){!1===e.concurrentSubscribes&&(this.glv=new r),this._subscriptions={},this._localToRemote={}}all(){return Object.values(this._subscriptions)}get(e){return this._subscriptions[e]}create(e,{subscribe:t,unsubscribe:n}){let i=this._subscriptions[e]=new s(e);return i.remoteId=this._localToRemote[e],i.subscriber=t,i.unsubscriber=n,i.gvl=this.glv,i}remove(e){delete this._subscriptions[e],delete this._localToRemote[e]}storeRemoteId(e,t){this._localToRemote[e]=t;let n=this.get(e);n&&(n.remoteId=t)}}class c{constructor(e={}){this.subscriptions=new o(e),this._pendingMessages=[],this._remoteToLocal={}}subscribe(e,t){this._remoteToLocal[t]=e,this.subscriptions.storeRemoteId(e,t),this.flush(t)}unsubscribe(e){let t=this.subscriptions.get(e);if(!t)return;let n=t.remoteId;n&&delete this._remoteToLocal[n],this.subscriptions.remove(e)}transmit(e,t,n){let i=this._remoteToLocal[e];if(!i)return void this._pendingMessages.push([e,t,n]);let s=this.subscriptions.get(i);s&&s.channels.forEach((e=>{e.receive(t,n)}))}close(){this._pendingMessages.length=0}get size(){return this.channels.length}get channels(){return this.subscriptions.all().flatMap((e=>e.channels))}flush(e){let t=[];for(let n of this._pendingMessages)n[0]===e?this.transmit(n[0],n[1],n[2]):t.push(n);this._pendingMessages=t}}class a extends Error{constructor(e,t){e instanceof Error?(super(e.message),this.cause=e):super(e),this.reason=t,this.name="ReasonError"}}class u extends a{constructor(e){super("Rejected",e),this.name="SubscriptionRejectedError"}}class l extends a{constructor(e){super(e||"Timed out to receive subscription ack"),this.name="SubscriptionTimeoutError"}}class h extends a{constructor(e,t){t?super(e,t):super("Disconnected",e),this.name="DisconnectedError"}}Error;class f extends h{constructor(e){super(e,"stale_connection"),this.name="StaleConnectionError"}}const d={debug:0,info:1,warn:2,error:3};class p{constructor(e){this.level=e||"warn"}log(e,t,n){d[e]<d[this.level]||this.writeLogEntry(e,t,n)}writeLogEntry(){throw Error("Not implemented")}debug(e,t){this.log("debug",e,t)}info(e,t){this.log("info",e,t)}warn(e,t){this.log("warn",e,t)}error(e,t){this.log("error",e,t)}}class g extends p{writeLogEntry(){}}function b(e){if(!e)return"";return`{${Object.keys(e).sort().filter((t=>void 0!==e[t])).map((t=>{let n=JSON.stringify(e[t]);return`${JSON.stringify(t)}:${n}`})).join(",")}}`}const m=Symbol("state");class y{constructor(e={}){this.emitter=i(),this.params=Object.freeze(e),this.initialConnect=!0,this[m]="idle"}get identifier(){return this._identifier||(this._identifier=b({channel:this.channelId,...this.params})),this._identifier}get channelId(){return this.constructor.identifier}get state(){return this[m]}attached(e){if(this.receiver){if(this.receiver!==e)throw Error("Already connected to a different receiver");return!1}return this.receiver=e,!0}connecting(){this[m]="connecting"}connected(){if("connected"===this.state)return;if("closed"===this.state)return;this[m]="connected";let e=!1;this.initialConnect?(this.initialConnect=!1,this.emit("connect",{reconnect:!1,restored:e})):this.emit("connect",{reconnect:!0,restored:e})}restored(){if("connected"===this.state)throw Error("Already connected");this[m]="connected";this.initialConnect=!1,this.emit("connect",{reconnect:!0,restored:!0})}disconnected(e){"disconnected"!==this.state&&"closed"!==this.state&&(this[m]="disconnected",this.emit("disconnect",e))}closed(e){"closed"!==this.state&&(this[m]="closed",delete this.receiver,this.initialConnect=!0,this.emit("close",e))}disconnect(){"idle"!==this.state&&"closed"!==this.state&&this.receiver.unsubscribe(this)}async perform(e,t){if("idle"===this.state||"closed"===this.state)throw Error("Channel is not subscribed");return this.receiver.perform(this.identifier,e,t)}async send(e){return this.perform(void 0,e)}receive(e,t){this.emit("message",e,t)}on(e,t){return this.emitter.on(e,t)}once(e,t){let n=this.emitter.on(e,((...e)=>{n(),t(...e)}));return n}emit(e,...t){return this.emitter.emit(e,...t)}ensureSubscribed(){return"connected"===this.state?Promise.resolve():"closed"===this.state?Promise.reject(Error("Channel is unsubscribed")):this.pendingSubscribe()}pendingSubscribe(){return this._pendingSubscribe||(this._pendingSubscribe=new Promise(((e,t)=>{let n=[()=>delete this._pendingSubscribe];n.push(this.on("connect",(()=>{n.forEach((e=>e())),e()}))),n.push(this.on("close",(e=>{n.forEach((e=>e())),t(e||new a("Channel was disconnected before subscribing","canceled"))})))}))),this._pendingSubscribe}}class w extends a{constructor(){super("No connection","closed"),this.name="NoConnectionError"}}class v extends y{static identifier="__ghost__";constructor(e,t){super(t),this.channelId=e}set channelId(e){this._channelId=e}get channelId(){return this._channelId}}const S=Symbol("state");class _{constructor({transport:e,protocol:t,encoder:n,logger:s,lazy:r,hubOptions:o}){this.emitter=i(),this.transport=e,this.encoder=n,this.logger=s||new g,this.protocol=t,this.protocol.attached(this),this.hub=new c(o||{}),this[S]="idle",this.handleClose=this.handleClose.bind(this),this.handleIncoming=this.handleIncoming.bind(this),this.transport.on("close",this.handleClose),this.transport.on("data",this.handleIncoming),this.initialConnect=!0,this.recovering=!1,!1===r&&this.connect().catch((()=>{}))}get state(){return this[S]}async connect(){if("connected"===this.state)return Promise.resolve();if("connecting"===this.state)return this.pendingConnect();this[S]="connecting";let e=this.pendingConnect();this.logger.debug("connecting");try{await this.transport.open()}catch(t){this.handleClose(t)}return e}setSessionId(e){this.sessionId=e,this.transport.setParam("sid",e)}connected(){if("connected"===this.state)return;this.logger.info("connected"),this[S]="connected",this.recovering&&this.hub.subscriptions.all().forEach((e=>e.notify("disconnected",new h("recovery_failed")))),this.hub.subscriptions.all().forEach((e=>this._resubscribe(e)));let e=!1;this.recovering=!1,this.initialConnect?(this.initialConnect=!1,this.emit("connect",{reconnect:!1,restored:e})):this.emit("connect",{reconnect:!0,restored:e})}restored(e){this.logger.info("connection recovered",{remoteIds:e}),this[S]="connected",this.hub.subscriptions.all().forEach((t=>{e&&t.remoteId&&e.includes(t.remoteId)?t.notify("restored"):(t.notify("disconnected",new h("recovery_failed")),this._resubscribe(t))}));let t=!this.initialConnect;this.recovering=!1,this.initialConnect=!1,this.emit("connect",{reconnect:t,restored:!0})}handleClose(e){this.logger.debug("transport closed",{error:e}),this.disconnected(new h(e,"transport_closed"))}disconnected(e){"connected"!==this.state&&"connecting"!==this.state||(this.logger.info("disconnected",{reason:e}),this[S]="disconnected",this.recovering=this.protocol.recoverableClosure(e),this.recovering?this.hub.subscriptions.all().forEach((e=>e.notify("connecting"))):this.hub.subscriptions.all().forEach((t=>{t.notify("disconnected",e)})),this.protocol.reset(e),this.hub.close(),this.transport.close(),this.emit("disconnect",e))}closed(e){if("closed"===this.state||"idle"===this.state)return;let t;e&&(t=e instanceof h?e:new h(e,void 0)),this.logger.info("closed",{reason:e||"user"}),this[S]="closed";let n=t||new h("cable_closed");this.hub.subscriptions.all().forEach((e=>e.notify("disconnected",n))),this.hub.close(),this.protocol.reset(),this.transport.close(),this.initialConnect=!0,this.emit("close",t)}disconnect(){this.closed()}handleIncoming(e){if("closed"===this.state||"idle"===this.state)return;let t=this.encoder.decode(e);if(void 0===t)return void this.logger.error("failed to decode message",{message:e});this.logger.debug("incoming data",t);let n=this.protocol.receive(t);if(n){this.logger.debug("processed incoming message",n);let{identifier:e,message:t,meta:i}=n;this.hub.transmit(e,t,i)}}send(e){if("closed"===this.state)throw Error("Cable is closed");let t=this.encoder.encode(e);void 0!==t?(this.logger.debug("outgoing message",e),this.transport.send(t)):this.logger.error("failed to encode message",{message:e})}keepalive(e){this.emit("keepalive",e)}subscribeTo(e,t){let n,i;return"string"===typeof e&&(i=e,e=v),n=i?new e(i,t):new e(t),this.subscribe(n)}subscribe(e){if(!e.attached(this))return e;let t=e.identifier;e.connecting();let n=this.hub.subscriptions.get(t)||this.hub.subscriptions.create(t,{subscribe:t=>this._subscribe(t,e.channelId,e.params),unsubscribe:e=>this._unsubscribe(e)});return n.add(e),"subscribed"===n.intent&&"connected"===n.state&&e.connected(),n.ensureSubscribed(),e}async _resubscribe(e){if("subscribed"!==e.intent)return;e.channels[0]&&(e.notify("connecting"),e.ensureResubscribed())}async _subscribe(e,t,n){let i=e.id;if("idle"===this.state&&this.connect().catch((()=>{})),"connected"!==this.state)return void this.logger.debug("cancel subscribe, no connection",{identifier:i});this.logger.debug("acquiring subscribe lock",{identifier:i});let s=await e.acquire("subscribed");if(s.canceled)return this.logger.debug("subscribe lock has been canceled",{identifier:i}),void s.release();if(this.logger.debug("subscribe lock has been acquired",{identifier:i}),"subscribed"!==e.intent)return this.logger.debug("cancel subscribe request, already unsubscribed"),void s.release();if("connected"!==this.state)return this.logger.debug("cancel subscribe, no connection",{identifier:i}),void s.release();if("connected"===e.state)return this.logger.debug("already connected, skip subscribe command",{identifier:i}),e.notify("connected"),void s.release();let r={identifier:t,params:n};this.logger.debug("subscribing",r);try{let s=await this.protocol.subscribe(t,n);this.hub.subscribe(i,s),this.logger.debug("subscribed",{...r,remoteId:s}),e.notify("connected")}catch(o){if(o){if(o instanceof u&&this.logger.warn("rejected",r),o instanceof h)return this.logger.debug("disconnected during subscription; will retry on connect",r),void s.release();this.logger.error("failed to subscribe",{error:o,...r})}e.close(o),this.hub.unsubscribe(i)}s.release()}unsubscribe(e){let t=e.identifier,n=this.hub.subscriptions.get(t);if(!n)throw Error(`Subscription not found: ${t}`);n.remove(e),e.closed(),n.maybeUnsubscribe()}async _unsubscribe(e){let t=e.id;this.logger.debug("acquiring unsubscribe lock",{identifier:t});let n=await e.acquire("unsubscribed");if(n.canceled)return this.logger.debug("unsubscribe lock has been canceled",{identifier:t}),void n.release();if(this.logger.debug("unsubscribe lock has been acquired",{identifier:t}),"unsubscribed"!==e.intent)return this.logger.debug("cancel unsubscribe, no longer needed",{identifier:t,intent:e.intent}),void n.release();if("disconnected"===e.state||"closed"===e.state)return this.logger.debug(`already ${e.state} connected, skip unsubscribe command`,{identifier:t}),void n.release();let i=e.remoteId;if(this.logger.debug("unsubscribing...",{remoteId:i}),"connected"!==this.state)return this.logger.debug("unsubscribe skipped (cable is not connected)",{id:t}),e.close(),this.hub.unsubscribe(t),void n.release();try{await this.protocol.unsubscribe(i),this.logger.debug("unsubscribed remotely",{id:t})}catch(s){s&&(s instanceof h?this.logger.debug("cable disconnected during the unsubscribe command execution",{id:t,error:s}):this.logger.error("unsubscribe failed",{id:t,error:s}))}"unsubscribed"===e.intent?(e.close(),this.hub.unsubscribe(t)):e.state="closed",n.release()}async perform(e,t,n){if("connecting"===this.state&&await this.pendingConnect(),"closed"===this.state||"disconnected"===this.state)throw new w;let i=this.hub.subscriptions.get(e);if(!i)throw Error(`Subscription not found: ${e}`);if(await i.pending("subscribed"),"subscribed"!==i.intent)throw Error(`Subscription is closed: ${e}`);let s=i.remoteId,r={id:s,action:t,payload:n};this.logger.debug("perform",r);try{let e=await this.protocol.perform(s,t,n);return e&&this.logger.debug("perform result",{message:e,request:r}),e}catch(o){throw this.logger.error("perform failed",{error:o,request:r}),o}}on(e,t){return this.emitter.on(e,t)}once(e,t){let n=this.emitter.on(e,((...e)=>{n(),t(...e)}));return n}emit(e,...t){return this.emitter.emit(e,...t)}pendingConnect(){return this._pendingConnect||(this._pendingConnect=new Promise(((e,t)=>{let n=[()=>delete this._pendingConnect];n.push(this.on("connect",(()=>{n.forEach((e=>e())),e()}))),n.push(this.on("close",(e=>{n.forEach((e=>e())),t(e)}))),n.push(this.on("disconnect",(e=>{n.forEach((e=>e())),t(e)})))}))),this._pendingConnect}}let k=0;class O{constructor(e={}){let{logger:t}=e;this.logger=t||new g,this.pendingSubscriptions={},this.pendingUnsubscriptions={},this.subscribeCooldownInterval=e.subscribeCooldownInterval||250,this.subscribeRetryInterval=e.subscribeRetryInterval||5e3}attached(e){this.cable=e}subscribe(e,t){let n={channel:e};t&&Object.assign(n,t);let i=b(n);if(this.pendingUnsubscriptions[i]){let n=1.5*this.subscribeCooldownInterval;return this.logger.debug(`unsubscribed recently, cooldown for ${n}`,i),new Promise((i=>{setTimeout((()=>{i(this.subscribe(e,t))}),n)}))}if(this.pendingSubscriptions[i])return this.logger.warn("subscription is already pending, skipping",i),Promise.reject(Error("Already subscribing"));let s=this.subscribeRetryInterval;return new Promise(((e,t)=>{let n=++k;this.pendingSubscriptions[i]={resolve:e,reject:t,id:n},this.cable.send(this.buildSubscribeRequest(i)),this.maybeRetrySubscribe(n,i,s)}))}buildSubscribeRequest(e){return{command:"subscribe",identifier:e}}maybeRetrySubscribe(e,t,n){setTimeout((()=>{let i=this.pendingSubscriptions[t];i&&i.id===e&&(this.logger.warn(`no subscription ack received in ${n}ms, retrying subscribe`,t),this.cable.send(this.buildSubscribeRequest(t)),this.maybeExpireSubscribe(e,t,n))}),n)}maybeExpireSubscribe(e,t,n){setTimeout((()=>{let i=this.pendingSubscriptions[t];i&&i.id===e&&(delete this.pendingSubscriptions[t],i.reject(new l(`Haven't received subscription ack in ${2*n}ms for ${t}`)))}),n)}unsubscribe(e){return this.cable.send({command:"unsubscribe",identifier:e}),this.pendingUnsubscriptions[e]=!0,setTimeout((()=>{delete this.pendingUnsubscriptions[e]}),this.subscribeCooldownInterval),Promise.resolve()}perform(e,t,n){return n||(n={}),n.action=t,this.cable.send({command:"message",identifier:e,data:JSON.stringify(n)}),Promise.resolve()}receive(e){if("object"!==typeof e)return void this.logger.error("unsupported message format",{message:e});let{type:t,identifier:n,message:i,reason:s,reconnect:r}=e;if("ping"===t)return this.cable.keepalive(e.message);if(this.cable.keepalive(),"welcome"===t){let t=e.sid;return t&&this.cable.setSessionId(t),this.cable.connected()}if("disconnect"===t){let e=new h(s);return this.reset(e),void(!1===r?this.cable.closed(e):this.cable.disconnected(e))}if("confirm_subscription"===t){let e=this.pendingSubscriptions[n];return e?(delete this.pendingSubscriptions[n],e.resolve(n)):(this.logger.error("subscription not found, unsubscribing",{type:t,identifier:n}),void this.unsubscribe(n))}if("reject_subscription"===t){let e=this.pendingSubscriptions[n];return e?(delete this.pendingSubscriptions[n],e.reject(new u)):this.logger.error("subscription not found",{type:t,identifier:n})}if(i)return{identifier:n,message:i};this.logger.warn(`unknown message type: ${t}`,{message:e})}reset(e){for(let t in this.pendingSubscriptions)this.pendingSubscriptions[t].reject(e);this.pendingSubscriptions={}}recoverableClosure(){return!1}}const A=()=>Date.now()/1e3|0;class E extends O{constructor(e={}){super(e),this.streamsPositions={},this.subscriptionStreams={},this.pendingHistory={},this.restoreSince=e.historyTimestamp,void 0===this.restoreSince&&(this.restoreSince=A()),this.sessionId=void 0,this.sendPongs=e.pongs}receive(e){if("object"!==typeof e)return void this.logger.error("unsupported message format",{message:e});let{type:t,identifier:n,message:i}=e;if("disconnect"===t||"reject_subscription"===t)return super.receive(e);if("confirm_subscription"===t)return this.subscriptionStreams[n]||(this.subscriptionStreams[n]=new Set),super.receive(e);if("ping"===t)return!1===!this.restoreSince&&(this.restoreSince=A()),this.sendPongs&&this.sendPong(),this.cable.keepalive(e.message);if(this.cable.keepalive(),"confirm_history"!==t)if("reject_history"!==t){if("welcome"===t){if(this.sessionId=e.sid,this.sessionId&&this.cable.setSessionId(this.sessionId),e.restored){let t=e.restored_ids||Object.keys(this.subscriptionStreams);for(let e of t)this.cable.send({identifier:e,command:"history",history:this.historyRequestFor(e)});return this.cable.restored(t)}return this.cable.connected(this.sessionId)}if(i){return{identifier:n,message:i,meta:this.trackStreamPosition(n,e.stream_id,e.epoch,e.offset)}}this.logger.warn(`unknown message type: ${t}`,{message:e})}else this.logger.warn("failed to retrieve history",e);else this.logger.debug("history result received",e)}buildSubscribeRequest(e){let t=super.buildSubscribeRequest(e),n=this.historyRequestFor(e);return n&&(t.history=n,this.pendingHistory[e]=!0),t}recoverableClosure(){return!!this.sessionId}historyRequestFor(e){let t={},n=!1;if(this.subscriptionStreams[e])for(let i of this.subscriptionStreams[e]){let e=this.streamsPositions[i];e&&(n=!0,t[i]=e)}if(n||this.restoreSince)return{since:this.restoreSince,streams:t}}trackStreamPosition(e,t,n,i){if(t&&n)return this.subscriptionStreams[e]||(this.subscriptionStreams[e]=new Set),this.subscriptionStreams[e].add(t),this.streamsPositions[t]={epoch:n,offset:i},{stream:t,epoch:n,offset:i}}async sendPong(){await new Promise((e=>setTimeout(e,0))),"connected"===this.cable.state&&this.cable.send({command:"pong"})}}class j{encode(e){return JSON.stringify(e)}decode(e){try{return JSON.parse(e)}catch(t){}}}class P{constructor(e,t={}){this.url=e;let n=t.websocketImplementation;if(n)this.Impl=n;else{if("undefined"===typeof WebSocket)throw new Error("No WebSocket support");this.Impl=WebSocket}this.connected=!1,this.emitter=i();let{format:s,subprotocol:r}=t;this.format=s||"text",this.connectionOptions=t.websocketOptions,this.subprotocol=r}displayName(){return"WebSocket("+this.url+")"}open(){return this.connectionOptions?this.ws=new this.Impl(this.url,this.subprotocol,this.connectionOptions):this.ws=new this.Impl(this.url,this.subprotocol),this.ws.binaryType="arraybuffer",this.initListeners(),new Promise(((e,t)=>{let n=[];n.push(this.once("open",(()=>{n.forEach((e=>e())),e()}))),n.push(this.once("close",(()=>{n.forEach((e=>e())),t(Error("WS connection closed"))})))}))}setURL(e){this.url=e}setParam(e,t){let n=new URL(this.url);n.searchParams.set(e,t);let i=`${n.protocol}//${n.host}${n.pathname}?${n.searchParams}`;this.setURL(i)}send(e){if(!this.ws||!this.connected)throw Error("WebSocket is not connected");this.ws.send(e)}close(){this.ws&&this.connected&&this.onclose()}on(e,t){return this.emitter.on(e,t)}once(e,t){let n=this.emitter.on(e,((...e)=>{n(),t(...e)}));return n}initListeners(){this.ws.onerror=e=>{this.connected&&this.emitter.emit("error",e.error||new Error("WS Error"))},this.ws.onclose=()=>{this.onclose()},this.ws.onmessage=e=>{let t=e.data;"binary"===this.format&&(t=new Uint8Array(t)),this.emitter.emit("data",t)},this.ws.onopen=()=>{this.connected=!0,this.emitter.emit("open")}}onclose(){this.ws.onclose=void 0,this.ws.onmessage=void 0,this.ws.onopen=void 0,this.ws.close(),delete this.ws,this.connected=!1,this.emitter.emit("close")}}const x={maxMissingPings:2,maxReconnectAttempts:1/0},I=()=>Date.now(),R=(e,t)=>{t=t||{};let{backoffRate:n,jitterRatio:i,maxInterval:s}=t;return n=n||2,void 0===i&&(i=.5),t=>{let r=e*n**t,o=r+(r*n-r)*Math.random();return o*=1+2*(Math.random()-.5)*i,s&&s<o&&(o=s),o}};class C{constructor({pingInterval:e,...t}){if(this.pingInterval=e,!this.pingInterval)throw Error(`Incorrect pingInterval is provided: ${e}`);if(t=Object.assign({},x,t),this.strategy=t.reconnectStrategy,!this.strategy)throw Error("Reconnect strategy must be provided");this.maxMissingPings=t.maxMissingPings,this.maxReconnectAttempts=t.maxReconnectAttempts,this.logger=t.logger||new g,this.state="pending_connect",this.attempts=0,this.disconnectedAt=I()}watch(e){this.target=e,this.initListeners()}reconnectNow(){return"connected"!==this.state&&"pending_connect"!==this.state&&"closed"!==this.state&&(this.cancelReconnect(),this.state="pending_connect",this.target.connect().catch((e=>{this.logger.info("Failed at reconnecting: "+e)})),!0)}initListeners(){this.unbind=[],this.unbind.push(this.target.on("connect",(()=>{this.attempts=0,this.pingedAt=I(),this.state="connected",this.cancelReconnect(),this.startPolling()}))),this.unbind.push(this.target.on("disconnect",(()=>{this.disconnectedAt=I(),this.state="disconnected",this.stopPolling(),this.scheduleReconnect()}))),this.unbind.push(this.target.on("close",(()=>{this.disconnectedAt=I(),this.state="closed",this.cancelReconnect(),this.stopPolling()}))),this.unbind.push(this.target.on("keepalive",(()=>{this.pingedAt=I()}))),this.unbind.push((()=>{this.cancelReconnect(),this.stopPolling()}))}dispose(){delete this.target,this.unbind&&this.unbind.forEach((e=>e())),delete this.unbind}startPolling(){this.pollId&&clearTimeout(this.pollId);let e=this.pingInterval+(Math.random()-.5)*this.pingInterval*.5;this.pollId=setTimeout((()=>{this.checkStale(),"connected"===this.state&&this.startPolling()}),e)}stopPolling(){this.pollId&&clearTimeout(this.pollId)}checkStale(){let e=I()-this.pingedAt;e>this.maxMissingPings*this.pingInterval&&(this.logger.warn(`Stale connection: ${e}ms without pings`),this.state="pending_disconnect",this.target.disconnected(new f))}scheduleReconnect(){if(this.attempts>=this.maxReconnectAttempts)return void this.target.close();let e=this.strategy(this.attempts);this.attempts++,this.logger.info(`Reconnecting in ${e}ms (${this.attempts} attempt)`),this.state="pending_reconnect",this.reconnnectId=setTimeout((()=>this.reconnectNow()),e)}cancelReconnect(){this.reconnnectId&&(clearTimeout(this.reconnnectId),delete this.reconnnectId)}}class L{constructor(e,t={}){this.transports=e,this.transport=null,this.emitter=i(),this.unbind=[],this.logger=t.logger||new g}displayName(){return"fallbacked transport"}async open(){for(let t=0;t<this.transports.length;t++){let n=this.transports[t];try{return this.transport=n,this.resetListeners(),this.logger.debug(`Trying to connect via ${n.displayName()}`),await n.open(),void this.logger.debug(`Connected via ${n.displayName()}`)}catch(e){this.logger.debug(`Failed to connect via ${n.displayName()}: ${e.message}`)}}throw this.transport=null,this.resetListeners(),new Error("Couldn't connect via any available transport")}send(e){if(!this.transport)throw new Error("No transport is open");this.transport.send(e)}async close(){if(!this.transport)throw new Error("No transport is open");await this.transport.close(),this.transport=null}setURL(){throw new Error("Not implemented. Set URL for each transport separately")}setParam(e,t){this.transports.forEach((n=>{n.setParam(e,t)}))}on(e,t){return this.emitter.on(e,t)}once(e,t){let n=this.emitter.on(e,((...e)=>{n(),t(...e)}));return n}get url(){return this.transport?this.transport.url:""}resetListeners(){this.unbind.forEach((e=>e())),this.unbind.length=0,this.transport&&this.unbind.push(this.transport.on("open",(()=>{this.emitter.emit("open")})),this.transport.on("data",(e=>{this.emitter.emit("data",e)})),this.transport.on("close",(e=>{this.emitter.emit("close",e)})),this.transport.on("error",(e=>{this.emitter.emit("error",e)})))}}const T={protocol:"actioncable-v1-json",pingInterval:3e3,maxReconnectAttempts:1/0,maxMissingPings:2,logLevel:"warn",lazy:!0};function B(e,t){if("object"===typeof e&&"undefined"===typeof t&&(t=e,e=void 0),t=t||{},!e&&!t.transport)throw Error("URL or transport must be specified");t=Object.assign({},T,t);let{protocol:n,websocketImplementation:i,websocketFormat:s,websocketOptions:r,fallbacks:o,logLevel:c,logger:a,transport:u,encoder:l,lazy:h,monitor:f,pingInterval:d,reconnectStrategy:p,maxMissingPings:b,maxReconnectAttempts:m,subprotocol:y,tokenRefresher:w,historyTimestamp:v,protocolOptions:S,concurrentSubscribes:k}=t;if(a=a||new g(c),"string"===typeof n){y=y||n;let e=n.substring(0,n.lastIndexOf("-")),t=n.substring(n.lastIndexOf("-")+1);if(S=S||{},"actioncable-v1"===e)n=new O({logger:a,...S});else{if("actioncable-v1-ext"!==e)throw Error(`Protocol is not supported yet: ${n}`);n=new E({logger:a,historyTimestamp:v,...S})}if("json"===t)l=l||new j,s=s||"text";else if("msgpack"===t){if(s="binary",!l)throw Error("Msgpack encoder must be specified explicitly. Use `@anycable/msgpack-encoder` package or build your own")}else{if("protobuf"!==t)throw Error(`Protocol is not supported yet: ${n}`);if(s=s||"binary",!l)throw Error("Protobuf encoder must be specified explicitly. Use `@anycable/protobuf-encoder` package or build your own")}}if(!n)throw Error("Protocol must be specified");u=u||new P(e,{websocketImplementation:i,websocketOptions:r,subprotocol:y,format:s}),o&&(u=new L([u,...o],{logger:a})),p=p||R(d),!1!==f&&(f=f||new C({pingInterval:d,reconnectStrategy:p,maxMissingPings:b,maxReconnectAttempts:m,logger:a}));let A=new _({protocol:n,transport:u,encoder:l,logger:a,lazy:h,hubOptions:{concurrentSubscribes:k}});return f&&(f.watch(A),A.monitor=f),w&&function(e,t){let n=!1;e.on("connect",(()=>n=!1)),e.on("close",(async i=>{i&&(n?e.logger.warn("Token auto-refresh is disabled",i):"token_expired"===i.reason&&(n=!0,await t()))}))}(A,(async()=>{try{await w(u)}catch(e){return a.error("Failed to refresh authentication token: "+e),!1}return A.connect().catch((()=>{})),!0})),A}class N{constructor(e){this.channel=e}notify(e,...t){"function"===typeof this[e]&&this[e](...t)}perform(e,t={}){this.channel.perform(e,t)}send(e){this.channel.send(e)}get identifier(){return this.channel.identifier}unsubscribe(){return this.channel.disconnect()}}class q extends v{constructor(e,t,n){super(e,t),this.subscription=new N(this),Object.assign(this.subscription,n),this.on("connect",(()=>this.subscription.notify("connected"))),this.on("disconnect",(()=>this.subscription.notify("disconnected",{allowReconnect:!0}))),this.on("message",(e=>this.subscription.notify("received",e))),this.on("close",(e=>{e&&e instanceof u?this.subscription.notify("rejected"):this.subscription.notify("disconnected",{allowReconnect:!1})}))}}class U{constructor(e){this.cable=e}create(e,t){let n,i;"object"===typeof e?(n=e.channel,delete e.channel,i=e):(n=e,i={});let s=new q(n,i,t);return s.subscription.notify("initialized"),this.cable.subscribe(s),s.subscription}findAll(e){return this.cable.hub.channels.filter((t=>t.identifier===e)).map((e=>e.subscription))}}class M{constructor(e){this.cable=e,this.subscriptions=new U(e)}}class $ extends p{writeLogEntry(e,t,n){n?console[e](t,n):console[e](t)}}class D extends C{watch(e){super.watch(e),this.initActivityListeners()}initActivityListeners(){if("undefined"!==typeof document&&"undefined"!==typeof window&&document.addEventListener&&window.addEventListener){let e=()=>{document.hidden||this.reconnectNow()&&this.logger.debug("Trigger reconnect due to visibility change")},t=e=>{this.reconnectNow()&&this.logger.debug("Trigger reconnect",{event:e})},n=()=>this.disconnect(new h("page_frozen"));document.addEventListener("visibilitychange",e,!1),window.addEventListener("focus",t,!1),window.addEventListener("online",t,!1),window.addEventListener("resume",t,!1),window.addEventListener("freeze",n,!1),this.unbind.push((()=>{document.removeEventListener("visibilitychange",e,!1),window.removeEventListener("focus",t,!1),window.removeEventListener("online",t,!1),window.removeEventListener("resume",t,!1),window.removeEventListener("freeze",n,!1)}))}}disconnect(e){"disconnected"!==this.state&&"closed"!==this.state&&(this.logger.info("Disconnecting",{reason:e.message}),this.cancelReconnect(),this.stopPolling(),this.state="pending_disconnect",this.target.disconnected(e))}}const z=["cable","action-cable"],F=(e,t)=>{for(let n of z){let i=e.head.querySelector(`meta[name='${n}-${t}']`);if(i)return i.getAttribute("content")}},H=e=>{if(e.match(/wss?:\/\//))return e;if("undefined"!==typeof window){return`${window.location.protocol.replace("http","ws")}//${window.location.host}${e}`}return e},W=()=>{if("undefined"!==typeof document&&document.head){let e=F(document,"url");if(e)return H(e)}return H("/cable")},J=()=>{if("undefined"!==typeof document&&document.head){let e=F(document,"history-timestamp");if(e)return 0|e}};function V(e,t){let n=function(e,t){"object"===typeof e&&"undefined"===typeof t&&(t=e,e=void 0),e=e||W(),t=t||{},t.historyTimestamp||=J(),t=Object.assign({},T,t);let{logLevel:n,logger:i,pingInterval:s,reconnectStrategy:r,maxMissingPings:o,maxReconnectAttempts:c}=t;return i=t.logger=t.logger||new $(n),r=t.reconnectStrategy=t.reconnectStrategy||R(s),!1!==t.monitor&&(t.monitor=t.monitor||new D({pingInterval:s,reconnectStrategy:r,maxMissingPings:o,maxReconnectAttempts:c,logger:i})),B(e,t)}(e,t);return new M(n)}},3608:function(e,t,n){"use strict";function i(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}n.d(t,{A:function(){return s}});var s=function e(t,n){function s(e,s,r){if("undefined"!==typeof document){"number"===typeof(r=i({},n,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var c in r)r[c]&&(o+="; "+c,!0!==r[c]&&(o+="="+r[c].split(";")[0]));return document.cookie=e+"="+t.write(s,e)+o}}return Object.create({set:s,get:function(e){if("undefined"!==typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],i={},s=0;s<n.length;s++){var r=n[s].split("="),o=r.slice(1).join("=");try{var c=decodeURIComponent(r[0]);if(i[c]=t.read(o,c),e===c)break}catch(a){}}return e?i[e]:i}},remove:function(e,t){s(e,"",i({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,i({},this.attributes,t))},withConverter:function(t){return e(i({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}}]);